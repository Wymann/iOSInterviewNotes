## 面试记录

### 1 第一次

#### 1.1  一面

电话 -  30min 面试官人很好，各种提示。



- **int 类型占多大**

和机器环境相关，iOS中占4个字节。

编译器可以根据自身硬件来选择合适的大小，但是需要满足约束：short和int至少为16位，long型至少为32位，并且short长度不能超过int，int不能超过long。当前主流的GCC编译器，32位机器和64位机器都是4个字节。



- **一个NSObject实例占多大**

系统分配了16个字节给NSObject对象（通过malloc_size函数获得）

NSObject对象内部只使用了8个字节的空间（64bit环境下，可以通过class_getInstanceSize函数获得）

因为底层里面，NSObject的对象就是一个内部只有一个指向Class的指针的结构体。一个指针占8个字节。（32位占4个字节，64位上占8个字节）。所以实际用到的就是8个字节。

但是alloc的过程中，instanceSize方法内会给小于16字节的对象分配16字节的内存大小。OC中对象最小内存空间大小是16字节。



- **简单说下栈和堆**

栈：编译器自动分配释放，不需要程序员手动管理。先入后出的数据结构。一般存放int、float等值类型。

堆：释放需要程序员管理。存储OC对象，引用类型。



- **堆实际上是什么结构**

堆通常可以看做是一棵树的数组对象。

满足以下性质：

堆中某个子节点的值总是不大于或不小于其父节点的值。

堆总是一棵完全二叉树。

跟节点最大或最小，分别叫做大根堆、小根堆。

相当于一维数组，有两个直接后继。



- **什么是字节序，大端字节序，小端字节序**

字节序就是多字节数据在计算机内存中存储或者网络传输时各字节的存储顺序。

一般分为大端字节序和小端字节序。一般来说0x2211使用两个字节存储：高位字节是0x22，低位字节是0x11。

大端字节序：高位字节在前，低位字节在后。

小端字节序：低位字节在前，高位字节在后。即以0x1122形式储存。

为什么不是统一大端字节序。为什么要有小端字节序？

计算机电路先处理低位字节，效率比较高，因为计算都是从低位开始的。所以，计算机的内部处理都是小端字节序。

但是，人类还是习惯读写大端字节序。所以，除了计算机内部处理，其他场合基本都是大端字节序。只有读取的时候，才必须区分字节序，其他情况都不用考虑。



- swift中Array和OC的NSArray的区别

Swift中是值类型，NSArray是引用类型。



- 值类型和引用类型分别适合什么场景

值类型每个实例都有其数据的一份副本，当被赋值给一个变量或常量，或传递给一个函数的时候，它会建立一份新的副本。

引用类型共享一个数据副本。当被赋值给一个变量或常量，或传递给一个函数的时候，一个引用类型一旦被初始化，会返回一个指向已存在实例的引用。

以下时候使用值类型：

想要用==比较实例数据。一个双等号用于比较值。

想复制来建立独立数据。

数据要在多线程的代码中使用，那么你就不用担心数据会被其他线程改变。

以下时候使用引用类型：

想用===比较实例一致性。===会检查两个对象是否完全一致，包括存储数据的内存地址。

你想要创建用于共享，可改变的数据。

值类型存储在栈中。引用类型存储在堆中。



- **简单说下HTTPS，随便拓展**

[HTTPS相关知识](https://github.com/tangshenghao/iOSInterviewNotes/blob/master/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/HTTP/HTTP.md)



- **证书怎么验证**

客户端取出提前内置在手机内部的认证机构的公钥。

用认证机构的公钥去解密公钥证书里面的数字签名。从而得到数字指纹。

客户端对公钥证书的服务器公钥进行数字摘要算法，从而生成数字指纹。

对比客户端自己生成的数字指纹和解密得到的数字指纹是否一致，如果一致则公钥证书验证通过，就可以进行后续的步骤。



- **怎么防止中间人代理**

需要验证证书是否是属于服务器的证书。



除了客户端保存一份证书与服务器的对比验证外，还有什么方式验证服务器证书

可以通过HTTP的接口获取服务器证书的数字指纹。（我后面猜的，具体答案我也还没想到）



- **GCD是怎么实现多线程操作的**

[GCD相关知识](https://github.com/tangshenghao/iOSInterviewNotes/blob/master/iOS%E5%9F%BA%E7%A1%80/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B.md)



- **简单说下循环引用，原因和举例**

循环引用，主要是持有关系产生了环，导致不能正常释放。

比如持有block属性后，在block中使用本类。

代理使用strong来修饰。

NSTimer中target直接使用self等。



- **NSTimer怎么解除循环引用**

在知道target要销毁前，手动执行NSTimer的Invalidate和置nil。

通过WeakProxy的方式，弱引用self，通过消息转发的方式执行消息。



**后面是音视频相关**

- **解释下RGB和YUV**

RGB就是正常的三原色，通过3个字节显示出颜色，做为一个像素。

YUV是通过Y的亮暗程度，和U、V的偏色形成图像，YUV之间有比例，4:4:4或4:2:2或4:2:0等。

[音视频基础知识](https://github.com/tangshenghao/iOSInterviewNotes/blob/master/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%9B%B8%E5%85%B3/%E8%A7%86%E9%A2%91H264%E7%BC%96%E8%A7%A3%E7%A0%81%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.md)



- **计算一下宽10高10的RGB多大。YUV多大。**

RGB：3个字节 * 10 * 10 = 300Byte

YUV：以4:2:0的比例来说，1个字节 * 10 * 10 + （前面的一半） = 150Byte。（50%的压缩率）



- **音频PCM编码过程**

[音频基础知识](https://github.com/tangshenghao/iOSInterviewNotes/blob/master/%E9%9F%B3%E8%A7%86%E9%A2%91%E7%9B%B8%E5%85%B3/%E9%9F%B3%E9%A2%91%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.md)



- **计算一下双声道8000Hz 16位 1分钟是多大**

16位 * 60 * 8000 * 2 = 15360000位 = 1920000字节 = 1875K



- **OC中的字典底层是怎么样？**

底层使用的是hash表来实现key和value之间的映射和存储。



- **字典的优点是什么？**

取值的时间复杂度是O(1)



- **什么结构取值也是O(1)**

数组



- **哈希表其实是什么结构？**

hash表其实是一个数组，区别数组的地方是它会建立存储的值到存储的下标索引的一个映射，也就是散列函数。

举例依次把3、12、24、30依次存入hash表中。假设映射关系是存储的索引下标 = 存储值 % hash表长度。



- **哈希表是怎么实现下标不是数字？**

通过散列函数来形成映射关系，来确定下标。



- **怎么解决哈希冲突？**

开放地址法：

使用一种探测方式在整个数组中找到另一个可以存储的地方。



链表法：

将链表和数组相结合，遇到哈希冲突，则将冲突的值加到链表中即可。



- **解决的两种方式的优缺点是什么？如果频繁存储应该使用那种？**

开放地址法：

容易产生堆积问题，不适合大规模的数据储存。插入时可能会多次冲突，删除的元素可能是多个冲突元素中的一个，需要对后面的元素作处理，实现较复杂。结点规模很大时会浪费很多空间。

链表法：

处理冲突简单，且无堆积现象，平均查找长度短。链表中的结点是动态申请的，适合构造表不能确定长度的情况。相对而言，链表法指针域可以忽略不计，因此较开放地址法更加节省空间。



#### 1.2 二面

视频会议，45分钟，面试官人非常好，给了很多提示。

聊了下过往项目，接下来给了两道代码题目。

题目1:

主要是解决低频、中频、高频调用是否能正常达到显示的效果。

```
@interface CEHandler: CEObject {
}

- (void)needUpdate; //this will be called when the data model has updates
- (void)redraw; //call this method to redraw the data on screen

@end

@interface CEHandler()
@property (nonatomic, strong) NSTimer *timer;
@end

@implementation CEHandler

- (void)needUpdate {

  if (self.timer) {
  		return;
  }
  // 最简单的timer就可以实现需求
  self.timer = [NSTimer scheduledTimerWithTimeInterval:0.3 repeats:NO block:^(NSTimer * _Nonnull timer) {
        [self.timer invalidate];
        self.timer = nil;
        [self redraw];
    }];
}

- (void)redraw {

}
```

题目2:

主要是C语言 & 和 == 的优先级问题。 

```
BOOL isHalfTransparent(unsigned int color) {
  if (color&0xFF == 0x7F) { // 存在优先级的问题。 == 的优先级 比 & 高。 所以会一直是False
    return TRUE;
  } else {
    return FALSE;
  }
}
```



#### 1.3 三面

现成面试，90分钟，面试官比较严肃，专注技术。

一套链表关联问题

生成添加100个随机的[-98, 97)的数据的链表。

删除其中为负值的链表。

用多线程来删除。

比较时间差异。给出原因。



说一些RN的知识点。

比较Flutter和RN的区别，以及现阶段要考虑使用的话需要从哪些方面考虑。

https://zhuanlan.zhihu.com/p/70070316

待整理

HTTPS和HTTP2的知识点。

是否了解MVP和MVVM。



#### 1.4 四面

电话面试，90分钟，应该是面委。

开始问了会不会脚本语言。并没有接触过。后面主要是聊业务，以及仔细说明做的业务。

最后问了碰到的难点和技术亮点。



#### 1.5 五面

电话面试，60分钟，通道面试。

开始问了JS中的闭包，表示并不知道。后面主要是聊业务，以及仔细说明做的业务。

最后问了碰到的难点和技术亮点。

四面和五面主要是考察以往的项目经验和解决问题的能力和亮点。



#### 总结：

1、基础能力需要都具备，iOS基础和原理、网络基础、基本数据结构和算法。

2、对于简历上的出现的内容都需要能准确描述以及回答。

3、一定要总结出做过的亮点技术以及解决过的能提现出技术能力的难题。



### 2 第二次

#### 2.1 一面

接到通知，去了现场面试，因为面试官想加速整个流程，所以一、二、三面都是在现场一次性面完。整个流程2个小时。

一面是两名面试官，人都很友好，介绍了一下当前项目的技术栈相关，然后我也简单介绍了下自己的情况。



- **RN的原理以及看过的源码简单说一下**

[RN源码相关](https://github.com/tangshenghao/iOSInterviewNotes/blob/master/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/RN/RN.md)



- **原生与RN的交互**

说了一下原生需要与RN交互的原生类的写法和注意事项，普通方法和带回调的方法如何实现，以及RN端JS代码如何调用。



- **追问交互的最底层是通过什么实现的**

我说了看了源码，在RCTCxxBridge内部会将消息，最终通过Websocket的方式发送给JS端，然后更详细的没有太深入了解。面试官反馈我看的那部分是调试情况下的源码。



- **提供给RN使用的原生组件实现以及细节**

 [RN源码相关](https://github.com/tangshenghao/iOSInterviewNotes/blob/master/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/RN/RN.md) ，说到了代码上如何实现，并简单说了下如何显示到屏幕上。接着追问了一些细节，因为不够深入没答上。



- **RN使用中碰到的问题**

说了一些项目中碰到的情况和问题，包括升级时的问题、频繁打印log、线上闪退的问题等，大部分能在github上找到对应的issue和解决办法，或者通过阅读源码解决问题。



- **H5与原生的交互方法，分别说下UIWebView和WKWebView**

分别说了UIWebView的三种方式，url拦截、JSContent、JSExport的OC实现，以及JS何如调用。以及WKWebView的三种方式，url拦截、MessageHandle、UIDelegate alert的OC实现以及JS调用。

说了下项目中的更新WKWebView的方法，[WKWebView更新方案](https://github.com/tangshenghao/iOSInterviewNotes/blob/master/iOS%E5%9F%BA%E7%A1%80/WKWebView%E6%95%B4%E7%90%86/WKWebView.md)



- **追问了H5，通过原生代码去拦截和替换图片以及视频资源的处理，解码图片的处理和嵌入原生播放器等**

之前没有接触过，没回答上。



- **SDWebImage的源码问题，图片的解码流程和缓存**

回答了缓存相关NSCache、NSMapTable和NSFileManager组合使用进行缓存。

解码相关问题没回答上。



- **动画一般怎么实现**

说了基本的UIView的animate和lottie，以及通过CADisplayLink实现的动态贝塞尔曲线渲染动画。

追问了CAAnimation，然后表示没有接触过。



- **后面问了些runtime和runloop，以及TCP和UDP的相关知识点。**

这部分大多数都会问，就不过多描述。



#### 2.2 二面

一面过后等了一会，就接着二面。面试官拿了杯水来，过程比较轻松一些。

主要是问了项目中用的RN相关内容，以及RN源码的内容，RN的相关线程做的事情，图片上的解码处理等。

接着就是聊一下项目，做过的方案和难点、技术点。

这一面聊得不多。



#### 2.3 三面

接着的三面，聊比较多，面试官应该是部门长。

聊了做的项目，方案，技术点。

抛出一个图片浏览器的需求进行方案讨论。

工作上的想法和计划，未来的职业行业的变化和计划等。

中途问了一个LRU如何实现（回答了字典+双向链表）。

过程比较愉快和顺畅，告知会尽快通知给领导。



#### 2.4 四面

等了很久，大概两个星期后，通知四面。估计是横向对比和安排领导时间了吧。

等的期间还以为是已经没了。

座机打过来的，直接聊项目，做的方案以及技术点。

在公司担任的职位和做的相关事情，碰到的难题等。

大概半个小时就沟通完了，问了下在职情况，告知会尽快通知同事。



#### 2.5 HR面

过了两天通知线上面试。一开始以为还是技术面，担心和上次一样的流程，因为上次还以为后面是HR面了。

等到面试时得知是HR面。

主要是详细说明每个阶段的公司以及职位和做的事情。

问一些换工作的原因、工作中的亮点等。

上家公司绩效和薪水奖金，绩效的评分标准等。

大概40分钟。



